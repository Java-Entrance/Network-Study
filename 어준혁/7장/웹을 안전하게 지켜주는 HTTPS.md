# [5주차] 7장. 웹을 안전하게 지켜주는 HTTPS

---

## 7.1 HTTP의 약점

### 1. 평문이기 때문에 도청이 가능

- HTTP를 사용한 리퀘스트나 리스폰스 통신 내용은 HTTP 자신을 암호화하는 기능은 없기 때문에 통신 전체가 암호화 되지는 않는다. 즉, 평문(암호화 되지 않은 메시지)으로 HTTP 메시지를 보내게 된다.

#### TCP/IP는 도청 가능한 네트워크

- TCP/IP의 구조의 통신 내용은 전부 통신 결로의 도중에 엿볼수 있다.

#### 암호화로 도청을 피하다

- 가장 보급되어 있는 기술

##### 1. 통신 암호화

- SSL이나 TLS이라는 다른 프로토콜을 조합함으로써 HTTP의 통신 내용을 암호화할 수 있다.

#### 2. 콘텐츠 암호화

- HTTP 메시지에 포함되는 콘텐츠만 암호화

---

### 2. 통신 상대를 확인하지 않기 때문에 위장 가능

- HTTP를 사용한 리퀘스트나 리스폰스에서는 통신 상대를 확인하지 않는다.

#### 누구나 리퀘스트를 할 수 있다.

#### 상대를 확인하는 증명서

- HTTP에서는 통신 상대를 확인할 수 없지만 SSL로 상대를 확인할 수 있다.
- SSL은 암호화뿐만 아니라 상대를 확인하는 수단으로 증명서를 제공하고 있다.
- 증명서는 신뢰할 수 있는 제3자 기관에 의해 발행되고 위조하는 것은 기술적으로 상당히 어렵다.
- 또한, 클라이언트가 증명서를 가짐으로써 본인 확인을 하고, 웹 사이트 인증에서 이용할 수도 있다.

---

### 3. 완전성을 증명할 수 없기 때문에 변조 가능

- 완전성을 증명할 수 없다는 것은 정보가 정확한지 아닌지를 확인할 수 없음을 의미한다.
- 통신 도중에 변조될 수 있기 때문에 발신된 리퀘스트나 리스폰스와 수신한 리퀘스트나 리스폰스가 같은지 아닌지를 확인할 수 없다.

---

## HTTP + 암호화 + 인증 + 완전한 보호 = HTTPS

- HTTP의 문제를 해결하기 위해서는 암호화와 인증과 완전성 보호 같은 구조를 HTTP에 추가할 필요가 있었다.
- 이 추가한 구조를 HTTPS라고 부른다.
- 웹 페이지의 로그인이나 쇼핑의 결제화면 등에서 사용된다.

### HTTPS는 SSL의 껍질을 덮어쓴 HTTP

- HTTPS는 새로운 애플리케이션 계층의 프로토콜이 아니라 HTTP 통신을 하는 소켓 부분을 SSL이나 TSL이라는 프로토콜로 대체하고 있을 뿐이다.
- 보통 HTTP는 직접 TCP와 통신하지만 SSL을 사용하는 경우에는 HTTP는 SSL와 SSL은 TCP와 통신하게 된다. **즉, SSL이라는 껍질을 덮어 쓴 HTTP가 HTTPS다.**

### 상호간에 키를 교환하는 공개키 암호화 방식

- SSL에서는 공개키 암호화 방식이라 불리는 암호화 방식을 채용하고 있다.

#### 공통키 암호의 딜레마

- 네트워크를 사용해서 키를 넘겨줄 때 통신이 도텅되어 공격자에게 키를 빼앗기게 되면 암호화의 의미가 없게 되어 버린다.

#### 두 개의 키를 사용하는 공개키 암호

- 공통키 암호의 문제를 해결하려고 한 것이 공개키 암호 방식
- 서로 다른 두 개의 키 페어(쌍)를 사용/ 비밀키 + 공개키
- 암호를 보내는 쪽이 상대의 공개키를 사용해 암호화 -> 정보를 받아들인 상대는 자신의 비밀키를 사용해 복호화(**비밀키를 보낼 필요가 없다**)

#### HTTPS는 하이브리드 암호 시스템

- HTTPS는 공통키 암호와 공개키 암호의 양쪽 성질을 가진 하이브리드 암호 시스템이다.
- 공개키 암호는 콩통키 암호에 비해서 처리속도가 늦는다. 그래서 모든 통신에 공개키 암호를 사용하는 것은 비효율적이다.

---

### 공개키를 정확한지 아닌지를 증명하는 증명서

- 공개키가 진짜인지 아닌지를 증명할 수 없는 문제점이 있다.
- 이 문제를 해결하기 위해 클라이언트와 서버가 모두 신뢰하는 제 3자 기관인 **인증 기관(CA)**과 **그 기관이 발행하는 공개키 증명서가 이용**되고 있다.

1. 서버의 운영자가 인증 기관에 공개키 제출
2. 인증 기관은 제출된 공개키에 디지털 서명을 하고 서명이 끝난 공개키를 만들고 인증서에 담음
3. 서버는 이 공개키 인증서를 클라이언트에 보내고 공개키 암호로 통신

#### 조직의 실제성을 증명하는 EV SSL증명서

#### 클라이언트를 확인하는 클라이언트 증명서

- 클라이언트 증명서를 이용하여 서버 증명서와 같이 서버가 통신하고 있는 상대가 의도한 클라이언트인 것을 증명하는 클라이언트 인증을 할 수 있다.

- 문제점

1. 유저가 클라이언트 증명서를 인스톨할 필요가 있다.
2. 유료이다.

#### 인증기관은 신용이 제일

#### 자기 인증 기관 발행 증명서는 '나야나' 증명서

---

### 안전한 통신을 하는 HTTPS의 구조

- SSL과 TLS
- SSL을 이용하면 서버와 클라이언트 모두 암호화와 복호화 처리가 필요하므로 CPU나 메모리 등의 하드웨어 리소스를 소비한다. 즉, 처리가 늦어지게 된다.

#### 왜 항상 HTTPS를 사용하지 않는가?

- 평문 통신에 비해서 암호화 통신은 CPU나 메모리 등 리소스가 많이 필요하기 때문에 액세스가 많은 웹 사이트 등에서 암호화를 하면 그 부하가 상당하다.
- 증명서를 구입해야 하기 때문에 구입 비용이 든다.
- 그렇기에 민감한 정보를 포함하지 않는 통신에서는 HTTP를 사용하고 개인 정보를 다룰 때만 HTTPS에 의한 암호화 통신을 사용한다.
