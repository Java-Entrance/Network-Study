# [2주차] 3장. HTTP 정보는 HTTP 메시지에 있다.

## HTTP 메시지

- HTTP 메시지란 HTTP에서 교환하는 정보이다.
- 복수 행의 데이터로 구성된 텍스트 문자열이다.
- 크게 구분하면 메시지 헤더와 메시지 바디로 구성되어 있다.
- 개행 문자(줄바꿈문자)로 메시지 헤더와 바디를 구분한다.

---

## 리퀘스트 메시지와 리스폰스 메시지의 구조

- **리퀘스트 라인**: 리퀘스트에 사용하는 메소드와 리퀘스트 URI와 사용하는 HTTP 버전이 포함
- **상태 라인**: 리스폰스 결과를 나타내는 상태 코드와 설명, 사용하는 HTTP 버전이 포함
- **헤더 필드**: 리퀘스트와 리스폰스의 여러 조건과 속성 등을 나타내는 각종 헤더 필드가 포함
- **그 외**: HTTP의 RFC에는 없는 헤더 필드(쿠키 등)가 포함되는 경우가 있다.

---

## 인코딩으로 전송 효율을 높이다.

- HTTP로 데이터를 전송할 경우 그대로 전송할 수 있지만 전송할 때에는 인코딩(변환)을 실시함으로써 전송 효율을 높일 수 있다.
- 인코딩을 하면 다량의 엑세스를 효율 좋게 처리할 수 있다. **단, CPU 등의 리소스는 보다 많이 소비한다.**

### 메시지 바디와 엔티티 바디의 차이

- **메시지**: HTTP 통신의 기본 단위로 옥텟 시퀀스로 구성되고 통신을 통해서 전송된다.
- **엔티티**: 리퀘스트랑 리스폰스의 페이로드로 전송되는 정보로 엔티티 헤더 필드와 엔티티 바디로 구성됩니다. 즉, HTTP 메시지(리퀘스트 혹은 리스폰스)의 바디에 적재되는 실제 데이터이다.

HTTP 메시지 바디의 역할은 리퀘스트랑 리스폰스에 관한 엔티티 바디를 운반하는 일이다. 기본적으로 메시지 바디와 엔티티 바디는 같지만 전송 코딩이 적용된 경우 엔티티 바디의 내용이 변화하기 때문에 메시지 바디와 달라진다.

### 압축해서 보내는 콘텐츠 코딩

- 콘텐츠 코딩은 엔티티에 적용하는 인코딩을 가리키는데 엔티티 정보를 유지한채로 압축한다. 콘텐츠 코딩된 엔티티는 수신한 클라이언트 측에서 디코딩한다.

#### 주요 콘텐츠 압축

- gzip(GNU zip)
- compress(UNIX의 표준 압축)
- deflate(zlib)
- identity(인코딩 없음)

#### 분해해서 보내는 청크 전송 코딩

- HTTP 통신에서는 리퀘스트했었던 리소스 전부에서 엔티티 바디의 전송이 완료되지 않으면 브라우저에 표시되지 않는다.

- 사이즈가 큰 데이터를 전송하는 경우에 데이터를 분할해서 조금씩 표시할 수 있다.

---

## 여러 데이터를 보내는 멀티파트

- 멀티파일은 메일에 사용하던 (MIME: 다목적 인터넷 메일 확장 사양)을 확장한 사양
- 멀티파트는 파트마다 헤더 필드가 포함된다.

---

## 일부분만 받는 레인지 리퀘스트

- 과거엔 대용량의 이미지와 데이터를 다운로드하기가 힘들었다.
- 다운로드 중 연결이 끊어질 경우 처음부터 다시 다운로드를 해야 했다.
- 이러한 문제를 해결하기 위해 리줌이라는 기능이 필요했다.
- 리줌 기능을 실현시키기 위해 엔티티 범위를 지정해서 다운로드를 할 필요가 있었다.
- **이 범위를 지정하는 것을 레인지 리퀘스트라 한다**.

- 레인지 리퀘스트에 대한 리스폰스는 상태 코드 `206`으로 응답하고 복수 범위는 `multilpart/byteranges`로 응답한다.
- 서버가 레인지 리퀘스트에 지원하지 않는 경우 상태 코드는 `200 OK`

---

## 최적의 콘텐츠를 돌려주는 네고시에이션

- 같은 콘텐츠이지만 여러 개의 페이지를 지닌 웹 페이지가 있다.
- 클라이언트에 더욱 적합한 리소스를 제공하기 위한 구조
